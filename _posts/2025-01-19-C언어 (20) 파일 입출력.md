---
title: C언어 (20) 파일 입출력
date: 2025-01-19 16:11:29 +09:00
last_modified_at: 2025-01-20 15:20:23 +09:00
categories: [language, C Language]
tags:
  [
    'C언어',
    'C Language',
    'C언어 기초'
  ]
---
# **C언어 (20) 파일 입출력**
> 프로그램은 파일을 통해 데이터를 받거나 쓰는 경우가 많다.<br>
> 이런 동작을 C언어로 해보자.

## 스트림(stream)
스트림(stream)이란 데이터를 입력하고 출력하기 위한 다리 같은 역할이다.<br>
키보드, 모니터 같은 입출력 장치들은 다양한 방식으로 데이터를 주고받는다.<br>

이 키보드와 프로그램, 프로그래뫄 모니터를 이어 주는 것이 스트림이다.<br>
스트림에는 표준 입출력 스트림인 stdin, 표준 출력 스트림인 stdout이 있다.<br>

![image](/assets/img/C_lang/20_1.PNG)

운영 체제에 의해 프로그램이 시작하면 키보드와 모니터에 대한 스트림들이 생성되고 종료되면 소멸시킨다.<br>
이렇게 스트림을 사용하면 입출력 장치에 상관없이 동일한 함수를 사용해 프로그램을 만들 수 있다.<br>

![image](/assets/img/C_lang/20_2.PNG)

키보드와 모니터만 입력 파일, 출력 파일로 바꿔주면 파일에서 입출력을 하는 프로그램이 된다.<br>
스트림은 모든 입력과 출력을 바이트들의 흐름으로 생각하기에 이런 동작을 가능하게 한다.<br>

![image](/assets/img/C_lang/18_3.PNG)

이렇게 표준 입력 스트림으로 입력된 값이 버퍼를 활용해 저장되고, 출력이 되는 것이다.<br>

## 파일
파일 입출력은 왜 필요할까?<br>
프로그램의 변수는 메모리에 생성되는데 메모리는 영구적인 기억 장치가 아니다.<br>
프로그램이 종료되면 프로그램 안의 데이터가 사라지고, 전원이 꺼지면 메모리의 데이터가 사라진다.<br>
그렇기에 데이터를 영구적으로 보관하려면 디스크 같은 보조 기억 장치에 데이터를 보관해야 한다.<br>

파일은 프로그램이 디스크에 데이터를 기록하는 단위로 text 파일과 binary 파일이 있다.<br>
text 파일은 우리가 쓰는 C언어 코드 같은 사람이 읽을 수 있는 텍스트가 들어 있는 파일이다.<br>
binary 파일은 0과 1로 되어있는 컴퓨터가 읽을 수 있는 실행 파일, 이미지 파일 등이다.<br>

## 파일 입출력
파일 입출력 과정은 4가지 과정으로 나눌 수 있다.<br>
> 파일 스트림 생성 -> 파일 열기 -> 파일 입출력 -> 파일 닫기

여태까지 키보드와 모니터에 대한 스트림을 생각하면서 프로그램을 만들어 주지는 않았다.<br>
왜냐하면 운영체제가 알아서 각각 stdin, stdout으로 생성해주기 때문이다.<br>
우리는 파일을 통해서 입력과 출력을 할 것이기 때문에 파일 스트림을 생성하고 파일과 이어줘야 한다.<br>

### fopen()
fopen() 함수는 파일 경로와 열기 모드를 인자로 받아 파일 스트림을 생성하고 파일을 연다.<br>
이 때 파일 스트림은 FILE 구조체 포인터를 의미한다.<br>

> FILE 구조체는 파일에 대한 내부 정보를 관리한다.<br>
> 이 구조체를 직접 다룰 필요는 없고, 다른 함수들을 통해 이용할 수 있다.<br>
> FILE 구조체 포인터를 통해서 파일에 접근할 수 있다는 것만 알아두고 넘어가자.<br>

```c
#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
int main() {
	FILE* fp;
	fp = fopen("text.txt", "w");
	if (fp == NULL) {
		printf("파일 열기 오류");
	}
	return 0;
}
```
text.txt의 파일 스트림을 FILE 포인터 fp에 할당한다.<br>
이 때 fopen()이 실패하면 NULL 포인터가 반환되므로 실패 여부를 확인할 수 있다.<br>

fopen() 의 두 번째 인자는 파일을 열 때 어떤 모드로 열 것인지를 나타낸다.<br>

| **모드**   | **설명**                                                            | **파일이 없을 때**              | **파일이 있을 때**                         | **파일 형식** |
|------------|---------------------------------------------------------------------|--------------------------------|-------------------------------------------|---------------|
| `"r"`      | 읽기 모드 (파일을 읽기만 가능)                                       | 열 수 없음 (파일이 있어야 함)   | 파일 열기 (파일 내용은 수정 불가)        | 텍스트         |
| `"w"`      | 쓰기 모드 (파일을 새로 생성하거나 기존 파일을 덮어쓰기)             | 새 파일 생성                   | 기존 파일 덮어쓰기 (내용 삭제 후 새로 작성) | 텍스트         |
| `"a"`      | 추가 모드 (파일에 데이터를 추가)                                     | 새 파일 생성                   | 파일 끝에 데이터 추가                    | 텍스트         |
| `"r+"`     | 읽기/쓰기 모드 (파일을 읽고 수정 가능)                               | 열 수 없음 (파일이 있어야 함)   | 파일 열기 (파일 내용 수정 가능)          | 텍스트         |
| `"w+"`     | 쓰기/읽기 모드 (파일을 새로 생성하거나 덮어쓰기, 읽기도 가능)       | 새 파일 생성                   | 기존 파일 덮어쓰기 (내용 삭제 후 새로 작성) | 텍스트         |
| `"a+"`     | 읽기/추가 모드 (파일을 읽고 추가할 수 있음)                         | 새 파일 생성                   | 파일 끝에 데이터 추가                    | 텍스트         |

모드는 이렇게 6가지가 있는데 read(읽기)의 r, write(쓰기)의 w, append(추가)의 a와<br>
뒤에 +를 붙이면 읽기와 쓰기를 모두 할 수 있도록 파일을 연다.<br>

기본적으로 파일은 텍스트 모드로 열리고, 바이너리 파일을 읽기 위해서는 'rb'처럼 b를 사용하면 된다.<br>

---
C언어에서 문자열은 다루기 왜 이렇게 복잡할까.. 그래도 귀찮은거지 어렵지는 않다.<br>
이제 파일 입출력, 메모리 할당, 컴파일 잡다한 이야기만 끝내면 C언어는 끝이 난다!